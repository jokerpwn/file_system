# EXT4架构
## 磁盘布局
* 引导块
* 块组1-n(128M)
  * superblock
  * inode
  * datablock(4KB)
* inode和datablock分配策略

    (1)  多块分配可以减少磁盘碎片。当文件初次创建的时候，块分配器预测性地分配8KB的磁盘空间给文件。当文件关闭的时候，未使用的空间当然也就释放了。但是如果推测是正确的，那么文件数据将写到一个多个块的extent中。

    (2)  延迟分配。当一个文件需要更多的数据块引起写操作时，文件系统推迟决定新数据在磁盘上的存放位置，直到脏的buffer写到磁盘为止。

    (3)  尽量保持文件的数据块与其inode在同一个块组中。可以减少磁盘寻道时间.

    (4)  尽量保持同一个目录中的所有inodes与目录位于同一个块组中。这样的假设前提是一个目录中的文件是相关的。

    (5)  磁盘卷被分成128MB的块组。当在根目录中创建目录时，inode分配器扫描块组并将新目录放到它找到的使用负荷最小的块组中。这可以保证目录在磁盘上的分散性。

    (6)  即使上述机制无效，仍然可以使用e4defrag整理碎片文件。
* superblock
  * 


  